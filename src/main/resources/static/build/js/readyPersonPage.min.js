$(document).ready(function(){var b=GetRequest();if(b.state!=""&&b.state!=null){loginByThird(b)}else{getUserStatus();var a=JSON.parse(getCookie("vr360_user_token"));if(a==null){}else{renderUserData()}}});var URL_TYPE={API_VERSION:"/v1",NONPUBLIC_PREFIX:"/v1/nonpub",PUB_PREFIX:"/v1/pub"};var authType={1:"QQ",2:"微信",3:"手机号码",4:"微博"};var personInfo={};var messageList=[];var paginationData={tempPage:1,pageCapacity:10};function getUserPhotoByStats(b){var a=null;$.ajax({url:URL_TYPE.NONPUBLIC_PREFIX+"/selectVrPhotoByUserAuthId",type:"get",headers:{token:JSON.parse(getCookie("vr360_user_token")).token},async:false,data:{stats:b},dataType:"json",success:function(c){a=c;return c},error:function(c){console.log(c);return null}});return a}function renderUserData(){$.ajax({url:URL_TYPE.NONPUBLIC_PREFIX+"/getUserInfo",headers:{token:JSON.parse(getCookie("vr360_user_token")).token},type:"get",dataType:"json",success:function(a){if(a.code==0){personInfo=a.data;$("#fans").text(personInfo.fans);$("#works").text(personInfo.works);$("#follow").text(personInfo.follow);if(a.data.sex=="b"){$(".usersex").html('<small><i class="fa fa-mars-stroke" aria-hidden="true"></i>&nbsp;&nbsp;男</small>')}else{if(a.data.sex=="g"){$(".usersex").html('<small><i class="fa fa-venus" aria-hidden="true"></i>&nbsp;&nbsp;女</small>')}else{$(".usersex").html('<small><i class="fa fa-venus-mars" aria-hidden="true"></i>&nbsp;&nbsp;保密</small>')}}$("#personDes").text(a.data.des);$("#userName").text(a.data.username);if(a.data.headerImg!="0"){$("#userHeadImg").attr("src",a.data.headerImg)}renderMyIndex()}else{$("#msgModal").text("登录失败");$("#msgModal").fadeIn();setTimeout(function(){$("#msgModal").fadeOut()},2000);showLoginBox()}},error:function(a){$("#msgModal").text("登录失败"+a.status);$("#msgModal").fadeIn();setTimeout(function(){$("#msgModal").fadeOut()},2000);showLoginBox()}})}function showMyIndex(a){paginationData.tempPage=1;$(".nav-list li").removeClass("leftBarActive");switch(a){case"person":$(".nav-list li:nth-of-type(1)").addClass("leftBarActive");renderMyIndex();break;case"create":$(".nav-list li:nth-of-type(2)").addClass("leftBarActive");$("#mainContainer").html('<div>\n                        <ul class="nav nav-tabs statsBar">\n                            <li role="presentation" class="active"><a href="javascript:changeStats(1)">待审核</a></li>\n                            <li role="presentation"><a href="javascript:changeStats(2)">已通过</a></li>\n                            <li role="presentation"><a href="javascript:changeStats(3)">未通过</a></li>\n\n                        </ul>\n                        <div class="col-xs-12 col-sm-12 col-md-12" id="photoContainer">\n                        </div>\n                    </div>');changeStats(1);break;case"fans":$(".nav-list li:nth-of-type(3)").addClass("leftBarActive");getFans(1,paginationData.pageCapacity);break;case"likeSomeOne":$(".nav-list li:nth-of-type(4)").addClass("leftBarActive");getFollows(1,paginationData.pageCapacity);break;case"setting":$(".nav-list li:nth-of-type(5)").addClass("leftBarActive");if(personInfo.authId!=null&&personInfo.authId!=""){$("#mainContainer").html('<div>\n                        <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-8 col-md-offset-2">\n                            <form class="form-horizontal" id="changeForm">\n                                <div class="form-group">\n                                    <label class="col-xs-2 col-sm-3 col-md-3 control-label">账户</label>\n                                    <div class="col-xs-10 col-sm-9 col-md-9" id="authId" style="color: #312b30;font-size: 15px;line-height: 36px">\n                                        17321914392\n                                    </div>\n                                </div>\n                                <div class="form-group">\n                                    <label for="change_username" class="col-xs-12 col-sm-3 col-md-3 control-label">用户名</label>\n                                    <div class="col-xs-12 col-sm-9 col-md-6">\n                                        <input type="text" class="form-control" name="change_username" id="change_username" placeholder="请输入你的用户名">\n                                        <span class="input-warning"></span>\n                                    </div>\n                                </div>\n                                <div class="form-group">\n                                    <label class="col-xs-12 col-sm-3 col-md-3 control-label">性别</label>\n                                    <div class="col-xs-12 col-sm-9 col-md-9" id="change_sex">\n                                        <label style="margin-left: 30px;" title="男孩">\n                                            <i class="fa fa-mars" aria-hidden="true" style="color: blueviolet;font-size: 20px"></i>&nbsp;&nbsp;\n                                            <input type="radio" name="change_sex" value="b">\n                                        </label>\n                                        <label style="margin-left: 30px;" title="女孩">\n                                            <i class="fa fa-venus" aria-hidden="true" style="color: red;font-size: 20px"></i>&nbsp;&nbsp;\n                                            <input type="radio" name="change_sex" value="g">\n                                        </label>\n                                        <label style="margin-left: 30px;" title="保密">\n                                            <i class="fa fa-venus-mars" aria-hidden="true" style="color: #1b6d85;font-size: 20px"></i>&nbsp;&nbsp;\n                                            <input type="radio" name="change_sex" value="s">\n                                        </label>\n                                        <span class="input-warning"></span>\n                                    </div>\n                                </div>\n                                <div class="form-group">\n                                    <label for="change_describe" class="col-xs-12 col-sm-3 col-md-3 control-label">个性签名</label>\n                                    <div class="col-xs-12 col-sm-9 col-md-9">\n                                        <input type="text" class="form-control" name="change_describe" id="change_describe" maxlength=\'32\' placeholder="编辑你的个性签名">\n                                        <span class="input-warning"></span>\n                                    </div>\n                                </div>\n                                <div class="form-group">\n                                    <label class="col-xs-6 col-sm-3 col-md-3 control-label">注册时间:</label>\n                                    <div class="col-xs-6 col-sm-9 col-md-9" id="registerTime" style="color: #74dac6;font-size: 15px;line-height: 36px">\n                                        2018年8月3日\n                                    </div>\n                                </div>\n                                <div class="form-group">\n                                    <label class="col-xs-6 col-sm-3 col-md-3 control-label">注册方式:</label>\n                                    <div class="col-xs-6 col-sm-9 col-md-9" id="registerType" style="color: #74dac6;font-size: 15px;line-height: 36px">\n                                        QQ\n                                    </div>\n                                </div>\n                                <div align="center"><a href="javascript:changePassword();">修改密码</a></div>\n                                <div id="changePasswordContainer" class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-6 col-md-offset-3" align="center">\n                                    <input type="password" class="form-control" name="oldPassword" placeholder="输入旧密码">\n                                    <input type="password" class="form-control" name="newPassword" placeholder="输入新密码">\n                                    <input type="password" class="form-control" name="newPassword" placeholder="再次输入新密码">\n                                    <span class="input-warning"></span>\n                                </div>\n                                <div class="col-xs-12 col-sm-12 col-md-12" style="margin-top: 50px;">\n                                    <div class="saveBtn" onclick="saveChange()">保存</div>\n                                </div>\n                            </form>\n                        </div>\n                    </div>');renderPersonInfo()}else{noticeLogin()}break;case"message":$(".nav-list li:nth-of-type(6)").addClass("leftBarActive");$("#mainContainer").html('<div>\n                        <h4>全部消息（ <span class="msgNum " id="notReadMes">0</span> / <span class="msgNum " id="totalMes">0</span> ）</h4>\n                        <ul id="msgContainer">\n                        </ul>\n                    </div>');getUserMessage(1,10);break}}function getFans(c,a){try{if(JSON.parse(getCookie("vr360_user_token")).token==null){$.alert("未登录或登录失效");getUserStatus()}else{$.ajax({url:URL_TYPE.NONPUBLIC_PREFIX+"/user/getFans",type:"get",headers:{token:JSON.parse(getCookie("vr360_user_token")).token},data:{tempPage:c,pageCapacity:a},success:function(d){if(d.code==5){$.alert("未登录或登录失效");getUserStatus();noticeLogin()}else{if(d.code==-1){$.alert("未知错误")}else{if(d.code==10){$("#mainContainer").html('<div class="noticeFont">您暂无粉丝哦~</div>')}else{if(d.code==0){renderFans(d.data);$("#pagination").pagination({currentPage:paginationData.tempPage,totalPage:Math.ceil(d.data.total/paginationData.pageCapacity),isShow:true,count:5,homePageText:"<<",endPageText:">>",prevPageText:"<",nextPageText:">",callback:function(e){paginationData.tempPage=e;getFans(e,paginationData.pageCapacity)}})}}}}},error:function(d){$.alert("获取消息错误"+d.status)}})}}catch(b){console.error(b);$.alert("未登录或登录失效");getUserStatus();noticeLogin()}}function renderFans(c){$("#mainContainer").html('<div class="row" id="fansContainer"></div>');$("#fansContainer").empty();for(var b in c.data){var a="normal-font";if(c.data[b].sex=="b"){a="blue-font"}else{if(c.data[b].sex=="g"){a="red-font"}}if(c.data[b].header=="0"){c.data[b].header="/images/source/admin-head.png"}$("#fansContainer").append('<div class="col-xs-4 col-sm-2 col-md-2" align="center">\n                            <a class="user-head" href=\'/p/people.html?uid='+c.data[b].authId+"'><img src='"+c.data[b].header+"'></a>\n                            <div class='user-name "+a+"'>"+c.data[b].name+"</div>\n                        </div>")}$("#fansContainer").append('<div class="col-xs-12 col-sm-12 col-md-12" align="center">\n            <div id="pagination" class=""></div>\n        </div>')}function getFollows(c,a){try{if(JSON.parse(getCookie("vr360_user_token")).token==null){$.alert("未登录或登录失效");getUserStatus()}else{$.ajax({url:URL_TYPE.NONPUBLIC_PREFIX+"/user/getFollows",type:"get",headers:{token:JSON.parse(getCookie("vr360_user_token")).token},data:{tempPage:c,pageCapacity:a},success:function(d){if(d.code==5){$.alert("未登录或登录失效");getUserStatus();noticeLogin()}else{if(d.code==-1){$.alert("未知错误")}else{if(d.code==10){$("#mainContainer").html('<div class="noticeFont">您暂无关注的人哦~</div>')}else{if(d.code==0){renderFollows(d.data);$("#pagination").pagination({currentPage:paginationData.tempPage,totalPage:Math.ceil(d.data.total/paginationData.pageCapacity),isShow:true,count:5,homePageText:"<<",endPageText:">>",prevPageText:"<",nextPageText:">",callback:function(e){paginationData.tempPage=e;getFollows(e,paginationData.pageCapacity)}})}}}}},error:function(d){$.alert("获取消息错误"+d.status)}})}}catch(b){console.error(b);noticeLogin()}}function renderFollows(c){$("#mainContainer").html('<div class="row" id="followContainer"></div>');$("#followContainer").empty();for(var b in c.data){var a="normal-font";if(c.data[b].sex=="b"){a="blue-font"}else{if(c.data[b].sex=="g"){a="red-font"}}if(c.data[b].header=="0"){c.data[b].header="/images/source/admin-head.png"}$("#followContainer").append('<div class="col-xs-4 col-sm-2 col-md-2" align="center">\n                            <a class="user-head" href=\'/p/people.html?uid='+c.data[b].authId+"'><img src='"+c.data[b].header+"' ></a>\n                            <div class='user-name "+a+"'>"+c.data[b].name+"</div>\n                        </div>")}$("#followContainer").append('<div class="col-xs-12 col-sm-12 col-md-12" align="center">\n            <div id="pagination" class=""></div>\n        </div>')}function noticeLogin(){$("#mainContainer").html('<div align="center" style="margin-top: 145px;">\n                        <img src="../images/source/error.png" style="width: 220px">\n                        <p>阿偶~出错了，您还未登录,请先前往登录哦~</p>\n                        <div class="button uploadBtn" onclick="showLoginBox()">立即登录</div>\n                    </div>')}function renderPersonInfo(){$("#authId").text(personInfo.authId);$("#change_username").val(personInfo.username);$("#change_sex input[value="+personInfo.sex+"]").click();$("#change_describe").val(personInfo.des);$("#registerTime").text(personInfo.registerTime);$("#registerType").text(authType[personInfo.registerType])}function changePassword(){var a=$("#changePasswordContainer").css("display");if(personInfo.registerType!="3"){$("#msgModal").text("无法进行该操作");$("#msgModal").fadeIn();setTimeout(function(){$("#msgModal").fadeOut()},2000)}else{if(a=="block"){$("input[name='oldPassword']").val("");$("input[name='newPassword']").val("");$("#changePasswordContainer").css("display","none")}else{$("#changePasswordContainer").css("display","block")}}}function saveChange(){var a=true;var b=$("#changeForm").serializeJson();$(".input-warning").text("");if(b.change_username==""){$("#change_username + .input-warning").text("请填入用户名");a=false}else{if(!filterSqlStr(b.change_username)){$("#change_username + .input-warning").text("请不要输入敏感字符");a=false}}if(!filterSqlStr(b.change_describe)){$("#change_describe + .input-warning").text("请不要输入敏感字符");a=false}if(b.change_sex==""||b.change_sex==null){$("#change_sex .input-warning").text("请选择性别");a=false}if(b.oldPassword!=""){if(b.newPassword==""){$("#changePasswordContainer .input-warning").text("请输入新密码");a=false}if(b.newPassword[0]!=b.newPassword[1]){$("#changePasswordContainer .input-warning").text("两次输入的新密码不一致");a=false}}if(a){uploadPersonInfo(b)}}function uploadPersonInfo(c){var b=new md5Util();var a={};a.changeUsername=c.change_username;a.changeSex=c.change_sex;a.changeDescribe=c.change_describe;if(a.changeDescribe==""){a.changeDescribe="此人很懒，什么也没留下"}if(c.oldPassword!=""&&c.newPassword!=""){a.oldPassword=b.hex_md5(b.hex_md5(c.oldPassword));a.newPassword=b.hex_md5(b.hex_md5(c.newPassword[0]))}else{a.oldPassword=null;a.newPassword=null}$.ajax({url:URL_TYPE.NONPUBLIC_PREFIX+"/uploadPersonInfo",type:"post",headers:{token:JSON.parse(getCookie("vr360_user_token")).token},async:false,data:{changeSex:a.changeSex,changeUsername:a.changeUsername,changeDescribe:a.changeDescribe,oldPassword:a.oldPassword,newPassword:a.newPassword},cache:false,dataType:"json",success:function(d){if(d.code==0){$.alert("保存成功,3s后自动刷新页面");setTimeout(function(){location.href=location.href},3000)}else{$.alert("保存失败，"+d.data)}},error:function(d){console.log(d.status);$.alert("保存失败，错误"+d.status)}})}function renderMyIndex(){var c={};try{c=getUserPhotoByStats(2)}catch(d){console.error(d)}$("#mainContainer").empty();if(c.code==0&&c.data.length>0){$("#mainContainer").html('<div class="col-xs-12 col-sm-12 col-md-12" id="photoContainer"></div>');for(var b=0;b<c.data.length;b++){var a;if(c.data[b].isRecommend==0){a="recommendHide"}else{a=""}$("#photoContainer").append('<div class="col-xs-6 col-sm-4 col-md-4" style="padding: 5px;margin: 0;">\n<div style="position: relative"><div class="recommendIcon '+a+"\">推荐</div></div>                                <a href='panorama.html?id="+c.data[b].id+'\' class="img-link" style="background-image: url('+c.data[b].url+')"></a>\n                                <div class="descr-container" >'+c.data[b].description+'</div>\n                                <div class="photoInfo">\n<i class="fa fa-eye" aria-hidden="true"></i>&nbsp;<span>'+c.data[b].viewNum+'</span>&nbsp;&nbsp;<i class="fa fa-heart-o" aria-hidden="true"></i>&nbsp;<span>'+c.data[b].heartNum+"</span>                                </div>\n                            </div>")}}else{$("#mainContainer").html('<div align="center" style="margin-top: 145px;">\n                        <img src="../images/source/upload-null.png" alt="">\n                        <p>您还没有上传作品，快去上传吧！</p>\n                        <div class="button uploadBtn" onclick="location.href=\'create360.html\'">立即上传</div>\n                    </div>')}}function changeStats(c){$(".statsBar li").removeClass("active");$("#photoContainer").empty();switch(c){case 1:$(".statsBar li:nth-of-type(1)").addClass("active");var d={};try{d=getUserPhotoByStats(1)}catch(f){console.error(f)}if(d.code==0&&d.data.length>0){for(var b=0;b<d.data.length;b++){var a;if(d.data[b].isRecommend==0){a="recommendHide"}else{a=""}$("#photoContainer").append('<div class="col-xs-6 col-sm-4 col-md-4" style="padding: 5px;margin: 0;">\n                                <a href=\'panorama.html?id='+d.data[b].id+'\' class="img-link" style="background-image: url('+d.data[b].url+')"></a>\n                                <div class="descr-container" >'+d.data[b].description+'</div>\n                                <div class="photoInfo">\n<i class="fa fa-eye" aria-hidden="true"></i>&nbsp;<span>'+d.data[b].viewNum+'</span>&nbsp;&nbsp;<i class="fa fa-heart-o" aria-hidden="true"></i>&nbsp;<span>'+d.data[b].heartNum+"</span>                                </div>\n                            </div>")}}else{$("#photoContainer").append('<div align="center" style="margin-top: 145px;">\n                        <img src="../images/source/nothing.png" style="width: 160px;">\n                        <div class="button uploadBtn" onclick="location.href=\'create360.html\'">立即制作</div>\n                    </div>')}break;case 2:$(".statsBar li:nth-of-type(2)").addClass("active");var d={};try{d=getUserPhotoByStats(2)}catch(f){console.error(f)}if(d.code==0&&d.data.length>0){for(var b=0;b<d.data.length;b++){var a;if(d.data[b].isRecommend==0){a="recommendHide"}else{a=""}$("#photoContainer").append('<div class="col-xs-6 col-sm-4 col-md-4" style="padding: 5px;margin: 0;">\n<div style="position: relative"><div class="recommendIcon '+a+"\">推荐</div></div>                                <a href='panorama.html?id="+d.data[b].id+'\' class="img-link" style="background-image: url('+d.data[b].url+')"></a>\n                                <div class="descr-container" >'+d.data[b].description+'</div>\n                                <div class="photoInfo">\n<i class="fa fa-eye" aria-hidden="true"></i>&nbsp;<span>'+d.data[b].viewNum+'</span>&nbsp;&nbsp;<i class="fa fa-heart-o" aria-hidden="true"></i>&nbsp;<span>'+d.data[b].heartNum+"</span>                                </div>\n                            </div>")}}else{$("#photoContainer").append('<div align="center" style="margin-top: 145px;">\n                        <img src="../images/source/nothing.png" style="width: 160px;">\n                        <div class="button uploadBtn" onclick="location.href=\'create360.html\'">立即制作</div>\n                    </div>')}break;case 3:$(".statsBar li:nth-of-type(3)").addClass("active");var d={};try{d=getUserPhotoByStats(3)}catch(f){console.error(f)}if(d.code==0&&d.data.length>0){for(var b=0;b<d.data.length;b++){var a;if(d.data[b].isRecommend==0){a="recommendHide"}else{a=""}$("#photoContainer").append('<div class="col-xs-6 col-sm-4 col-md-4" style="padding: 5px;margin: 0;">\n                                <a href=\'panorama.html?id='+d.data[b].id+'\' class="img-link" style="background-image: url('+d.data[b].url+')"></a>\n                                <div class="descr-container" >'+d.data[b].description+'</div>\n                                <div class="photoInfo">\n<i class="fa fa-eye" aria-hidden="true"></i>&nbsp;<span>'+d.data[b].viewNum+'</span>&nbsp;&nbsp;<i class="fa fa-heart-o" aria-hidden="true"></i>&nbsp;<span>'+d.data[b].heartNum+"</span>                                </div>\n                            </div>")}}else{$("#photoContainer").append('<div align="center" style="margin-top: 145px;">\n                        <img src="../images/source/nothing.png" style="width: 160px;">\n                        <div class="button uploadBtn" onclick="location.href=\'create360.html\'">立即制作</div>\n                    </div>')}break}}function getUserMessage(c,a){try{if(JSON.parse(getCookie("vr360_user_token")).token==null){$.alert("未登录或登录失效");getUserStatus();noticeLogin()}else{$.ajax({url:URL_TYPE.NONPUBLIC_PREFIX+"/getUserMessageList",type:"get",headers:{token:JSON.parse(getCookie("vr360_user_token")).token},data:{tempPage:c,pageCapacity:a},success:function(d){if(d.code==5){$.alert("未登录或登录失效");getUserStatus();noticeLogin()}else{if(d.code==-1){$.alert("未知错误")}else{if(d.code==0){renderMessage(d.data);$("#pagination").pagination({currentPage:paginationData.tempPage,totalPage:Math.ceil(d.data.data.total/paginationData.pageCapacity),isShow:true,count:5,homePageText:"<<",endPageText:">>",prevPageText:"<",nextPageText:">",callback:function(e){paginationData.tempPage=e;getUserMessage(e,paginationData.pageCapacity)}})}}}},error:function(d){$.alert("获取消息错误"+d.status)}})}}catch(b){console.error(b);noticeLogin()}}function renderMessage(e){messageList=e.messages;$("#notReadMes").text(e.data.notRead);$("#totalMes").text(e.data.total);$("#msgContainer").empty();for(var d in e.messages){var c=new Date(parseInt(e.messages[d].time));var b="";var a="";if(e.messages[d].read==0){b="msgNot"}else{b="hide"}if(e.messages[d].img=="0"){e.messages[d].img="/images/source/small.png"}$("#msgContainer").append('<li>\n                                <div class="msgList row">\n                                    <div  class="col-xs-12 col-sm-6 col-md-6">\n                                        <div><div class='+b+'></div><span class="msgType">['+e.messages[d].author+"]</span>&nbsp;&nbsp;<span class=\"msgTile\"><a href='javascript:void(0);' onclick='readeMessage("+d+")' target='_blank'>"+e.messages[d].title+'</a></span> <span class="msgTime">'+(parseInt(c.getMonth())+1)+"月"+c.getDate()+"日 "+c.getHours()+":"+c.getMinutes()+'</span></div>\n                                        <div class="msgDes">'+e.messages[d].content+"</div>\n                                    </div>\n                                    <div class='col-xs-12 col-sm-6 col-md-6' align=\"center\">\n                                        <a href='"+e.messages[d].link+"' target='_blank'><img src='"+e.messages[d].img+'\'\n                                                        alt="" class="msgImg "></a>\n                                    </div>\n                                </div>\n                            </li>')}$("#msgContainer").append('<div class="col-xs-12 col-sm-12 col-md-12" align="center">\n            <div id="pagination" class=""></div>\n        </div>')}function readeMessage(b){if(messageList[b].img=="0"){messageList[b].img="/images/source/small.png"}var a=new Date(parseInt(messageList[b].time));$("#readerModal .modal-body").html('<span class="msgTime">'+(parseInt(a.getMonth())+1)+"月"+a.getDate()+"日 "+a.getHours()+":"+a.getMinutes()+"&nbsp;&nbsp;&nbsp;</span>\n"+messageList[b].content+'                <div align="center">\n                    <a href=\''+messageList[b].link+"' target='_blank'><img src='"+messageList[b].img+'\'\n                                    style="width: 80%;margin: 15px;"></a>\n                </div>');$("#readerModal").modal("show");updateUserMessageReadStatus(messageList[b].id);getUserMessage(1,10)}function updateUserMessageReadStatus(b){try{if(JSON.parse(getCookie("vr360_user_token")).token==null){$.alert("未登录或登录失效");getUserStatus();noticeLogin()}else{$.ajax({url:URL_TYPE.NONPUBLIC_PREFIX+"/readUserMessage",type:"post",headers:{token:JSON.parse(getCookie("vr360_user_token")).token},data:{id:b},async:false,success:function(c){if(c.code==5){$.alert("未登录或登录失效");getUserStatus();noticeLogin()}},error:function(c){$.alert("更新消息失败"+c.status)}})}}catch(a){console.error(a);noticeLogin()}}function barShowAndHide(){if($(".navList-left").css("left")=="0px"){$(".navList-left").css("left","-135px")}else{$(".navList-left").css("left","0px")}}function loginByThird(a){$.ajax({type:"post",url:URL_TYPE.PUB_PREFIX+"/loginByThird",data:{type:a.state,code:a.code},dataType:"JSON",success:function(b){if(b.code!=0){$("#msgModal").text("登录失败");$("#msgModal").fadeIn();setTimeout(function(){$("#msgModal").fadeOut()},2000);showLoginBox()}else{setCookie("vr360_user_token",JSON.stringify(b.data),"h1");hideLoginBox();location.href=location.href.split("?")[0]}},error:function(b){$("#msgModal").text("登录失败"+b.status);$("#msgModal").fadeIn();setTimeout(function(){$("#msgModal").fadeOut()},2000);showLoginBox()}})}function GetRequest(){var b=location.search;var a=new Object();if(b.indexOf("?")!=-1){var d=b.substr(1);strs=d.split("&");for(var c=0;c<strs.length;c++){a[strs[c].split("=")[0]]=unescape(strs[c].split("=")[1])}}return a}function fmtDate(c){var b=new Date(c);var f=1900+b.getYear();var a="0"+(b.getMonth()+1);var e="0"+b.getDate();return f+"-"+a.substring(a.length-2,a.length)+"-"+e.substring(e.length-2,e.length)}function filterSqlStr(c){var b=["-","+","*","#","&"];for(var a in b){if(c.indexOf(b[a])!=-1){return false}}return true}console.log("欢迎使用VR 360全景\n小本网站还请大神勿黑，手下留情呀~~\n如有什么疑问请联系\nQQ：1246886075\nvr.beifengtz.com");